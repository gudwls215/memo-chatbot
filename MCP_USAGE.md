# MCP μ„λ²„ λ° ν΄λΌμ΄μ–ΈνΈ λ…λ¦½ μ‹¤ν–‰ κ°€μ΄λ“

## κ°μ”

μ΄ ν”„λ΅μ νΈλ” FastMCPλ¥Ό μ‚¬μ©ν•μ—¬ MCP (Model Context Protocol) μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈλ¥Ό λ…λ¦½μ μΌλ΅ μ‹¤ν–‰ν•  μ μμµλ‹λ‹¤. FastMCPλ” λ°μ½”λ μ΄ν„° κΈ°λ°μ κ°„λ‹¨ν• APIλ¥Ό μ κ³µν•μ—¬ MCP μ„λ²„λ¥Ό μ‰½κ² κµ¬ν„ν•  μ μκ² ν•΄μ¤λ‹λ‹¤.

## μ‹¤ν–‰ λ¨λ“

### 1. ν†µν•© λ¨λ“ (κΈ°λ³Έ, κ¶μ¥)

ν΄λΌμ΄μ–ΈνΈκ°€ μ‹¤ν–‰λ  λ• μλ™μΌλ΅ MCP μ„λ²„λ¥Ό subprocessλ΅ μ‹μ‘ν•©λ‹λ‹¤.

```bash
# .env νμΌ μ„¤μ •
MCP_MODE=stdio

# μ‹¤ν–‰
uv run python chatbot/main.py
```

**μ¶λ ¥ μμ‹:**
```
π€ stdio λ¨λ“λ΅ MCP μ„λ²„ μ‹μ‘ μ¤‘...
β… MCP λ‚΄μ¥ μ„λ²„ μ—°κ²° μ™„λ£! μ‚¬μ© κ°€λ¥ν• λ„κµ¬: ['create_memo', 'list_memos', 'get_memo', 'update_memo', 'delete_memo']
```

### 2. λ¶„λ¦¬ λ¨λ“ (μ‹¤ν—μ  - SSE μ§€μ›)

μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈλ¥Ό λ³„λ„μ ν”„λ΅μ„Έμ¤λ΅ μ‹¤ν–‰ν•©λ‹λ‹¤.

> β οΈ **μ£Όμ**: SSE λ¨λ“λ” μ‹¤ν—μ  κΈ°λ¥μΌλ΅ μ™„μ „ν μ•μ •μ μ΄μ§€ μ•μ„ μ μμµλ‹λ‹¤.
> ν”„λ΅λ•μ… ν™κ²½μ—μ„λ” stdio λ¨λ“(ν†µν•© λ¨λ“)λ¥Ό μ‚¬μ©ν•μ‹κΈ° λ°”λλ‹λ‹¤.

#### 2.1 MCP μ„λ²„ λ¨Όμ € μ‹¤ν–‰

**ν„°λ―Έλ„ 1: MCP μ„λ²„ μ‹¤ν–‰**

```bash
# SSE HTTP μ„λ²„λ΅ μ‹¤ν–‰
uv run python mcp-server/mcp_server_sse.py
```

μ„λ²„κ°€ μ‹¤ν–‰λλ©΄ λ‹¤μκ³Ό κ°™μ€ λ©”μ‹μ§€κ°€ ν‘μ‹λ©λ‹λ‹¤:
```
============================================================
π€ MCP μ„λ²„ (SSE λ¨λ“) μ‹μ‘
============================================================
μ„λ²„ μ£Όμ†: http://localhost:8001
SSE μ—”λ“ν¬μΈνΈ: http://localhost:8001/sse
```

#### 2.2 ν΄λΌμ΄μ–ΈνΈ μ‹¤ν–‰

**ν„°λ―Έλ„ 2: μ±—λ΄‡ ν΄λΌμ΄μ–ΈνΈ μ‹¤ν–‰**

```bash
# .env νμΌ μ„¤μ •
MCP_MODE=sse
MCP_SERVER_URL=http://localhost:8001/sse

# μ‹¤ν–‰
uv run python chatbot/main.py
```

## ν™κ²½ λ³€μ

`.env` νμΌμ—μ„ λ‹¤μ λ³€μλ¥Ό μ„¤μ •ν•  μ μμµλ‹λ‹¤:

```env
# MCP μ—°κ²° λ¨λ“
MCP_MODE=stdio          # stdio (κΈ°λ³Έ, κ¶μ¥) λλ” sse (μ‹¤ν—μ )

# MCP μ„λ²„ URL (SSE λ¨λ“μΌ λ•λ§ μ‚¬μ©)
MCP_SERVER_URL=http://localhost:8001/sse

# OpenAI API ν‚¤
OPENAI_API_KEY=your_api_key_here

# FastAPI λ°±μ—”λ“ URL
MEMO_API_URL=http://localhost:8000
```

## μ¥λ‹¨μ 

### stdio λ¨λ“ (ν†µν•©) - κ¶μ¥ β…
- β… κ°„νΈν• μ‹¤ν–‰ (ν•λ‚μ λ…λ Ήμ–΄λ΅ λ¨λ‘ μ‹¤ν–‰)
- β… λ¦¬μ†μ¤ κ΄€λ¦¬ μλ™ν™”
- β… μ•μ •μ μ΄κ³  κ²€μ¦λ λ°©μ‹
- β… ν”„λ΅μ„Έμ¤ κ°„ ν†µμ‹  μ¤λ²„ν—¤λ“ μµμ†
- β μ„λ²„ μ¬μ‹μ‘ μ‹ ν΄λΌμ΄μ–ΈνΈλ„ μ¬μ‹μ‘ ν•„μ”

### SSE λ¨λ“ (λ¶„λ¦¬) - μ‹¤ν—μ  β οΈ
- β… μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈ λ…λ¦½μ μΌλ΅ μ¬μ‹μ‘ κ°€λ¥
- β… μ—¬λ¬ ν΄λΌμ΄μ–ΈνΈκ°€ ν•λ‚μ μ„λ²„μ— μ—°κ²° κ°€λ¥ (μ΄λ΅ μƒ)
- β… μ„λ²„ λ””λ²„κΉ… λ° λ¨λ‹ν„°λ§ μ©μ΄
- β λ‘ κ°μ ν„°λ―Έλ„ ν•„μ”
- β μ„λ²„λ¥Ό λ¨Όμ € μ‹¤ν–‰ν•΄μ•Ό ν•¨
- β λ„¤νΈμ›ν¬ μ¤λ²„ν—¤λ“
- β ν„μ¬ μ™„μ „ν μ•μ •μ μ΄μ§€ μ•μ

## λ””λ ‰ν† λ¦¬ κµ¬μ΅°

```
memo-chatbot/
β”β”€β”€ chatbot/              # μ±—λ΄‡ ν΄λΌμ΄μ–ΈνΈ
β”‚   β”β”€β”€ main.py          # ν΄λΌμ΄μ–ΈνΈ μ§„μ…μ 
β”‚   β”β”€β”€ nodes.py         # MCP ν΄λΌμ΄μ–ΈνΈ μ—°κ²° λ΅μ§
β”‚   β””β”€β”€ graph.py         # LangGraph μ›ν¬ν”λ΅μ°
β”β”€β”€ mcp-server/          # MCP μ„λ²„
β”‚   β”β”€β”€ server.py        # stdio λ¨λ“ μ„λ²„
β”‚   β”β”€β”€ mcp_server_sse.py # SSE λ¨λ“ μ„λ²„
β”‚   β””β”€β”€ tools.py         # λ©”λ¨ κ΄€λ¦¬ λ„κµ¬
β”β”€β”€ run_mcp_server.py    # μ„λ²„ λ…λ¦½ μ‹¤ν–‰ μ¤ν¬λ¦½νΈ
β””β”€β”€ .env                 # ν™κ²½ λ³€μ μ„¤μ •
```

## λ¬Έμ  ν•΄κ²°

### μ„λ²„ μ—°κ²° μ‹¤ν¨

SSE λ¨λ“μ—μ„ ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ²„μ— μ—°κ²°ν•  μ μ—†λ” κ²½μ°:

1. MCP μ„λ²„κ°€ μ‹¤ν–‰ μ¤‘μΈμ§€ ν™•μΈ
2. `.env`μ `MCP_SERVER_URL`μ΄ μ¬λ°”λ¥Έμ§€ ν™•μΈ
3. ν¬νΈ μ¶©λμ΄ μ—†λ”μ§€ ν™•μΈ (κΈ°λ³Έ: 8001)

### λ„κµ¬ λ©λ΅μ΄ λΉ„μ–΄μμ

1. FastAPI λ°±μ—”λ“κ°€ μ‹¤ν–‰ μ¤‘μΈμ§€ ν™•μΈ (`MEMO_API_URL`)
2. MCP μ„λ²„ λ΅κ·Έμ—μ„ μ¤λ¥ ν™•μΈ
